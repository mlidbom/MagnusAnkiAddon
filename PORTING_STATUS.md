# JAStudio Python to C# Porting Status

## Porting Rules

**Stay faithful to the Python - refactoring comes later.** We want almost completely equivalent code, only in C#.

### Why Stay So Close?

Staying this close to the Python is what makes the porting workable at all. If we start changing things while porting, it's like letting go with both hands while climbing - we have nothing to rely on, nothing keeping us from falling. **Mirroring the Python is our handgrip.** Until we have all the tests ported and working, NO significant redesigns or "fixes" will be done, even if we spot inconsistencies or improvements.

### Rules

- **File structure:** Classes should be in the equivalent file in C# as in Python. Do not put them in other files willy-nilly.
- **Naming - files:** Python filename `my_class_name.py` becomes `MyClassName.cs`. Underscores convert to PascalCase, but don't rename the file to something completely different.
- **Naming - classes/members:** Use .NET naming standards (PascalCase for public members, etc.) but keep the same names. `my_function_name` becomes `MyFunctionName`, not something completely different.
- **Public API must match:** New public methods, properties, or fields on a class count as NOT matching unless there is a documented good reason. If Python has methods A, B, C then C# should have methods A, B, C - not A, B, C, D. Extra public members mean other code has changed, breaking the faithful port.
- **Mirror inconsistencies:** Even if the Python has inconsistencies (class names not matching file names, weird organization, etc.), mirror them in C#. Do NOT "fix" inconsistencies as part of porting.
- **WeakRef:** Replace with standard references in .NET (C# has better garbage collection).
- **Class organization:** If a class is in a separate file in Python, it should be in the equivalent .cs file. If classes are together in the same file in Python, same for C#.
- **Missing dependencies:** When ported code doesn't compile due to missing classes, create them. If too complex to implement immediately, create members throwing `NotImplementedException`.
- **Implementation completeness:** Either fully implement a member or throw `NotImplementedException`. Do NOT return nonsense values.
- **Constants/literals:** Do NOT create new constants or magic literals duplicating existing ones. Access constants from the .NET equivalent of the classes they're in in Python.
- **No code duplication:** If the Python file uses constants and/or methods defined in another class/module, the C# should too unless there is a really good reason. Don't duplicate - reference the original.
- **String interning:** Python-specific optimization for memory management. Not needed in C# - skip it.
- **Different implementation vs different functionality:**
  - **Different implementation = OK** (e.g., List vs QSet, WeakRef vs direct reference, different but equivalent algorithms)
  - **Different functionality = BROKEN** If the code doesn't behave the same way, it's incomplete/buggy and must be marked with a lower percentage explaining what's broken.

## Legend
- **CREATED WIP** - C# equivalent exists but needs verification for equivalence
- **MISSING** - No C# equivalent exists yet
- **COMPLETE** - C# equivalent verified as functionally equivalent to Python
  **EXCLUDED** - Should not be ported.

---

## File Structure

- jaspythonutils_src/jaspythonutils/sysutils map to JAStudio.Core/SysUtils
    - json
        - 100% json_reader.py
    - 100% kana_utils.py

- jaslib_src/jaslib
    - 90% app.py
        - All core functionality present; uses List vs QSet, path computation slightly different
    - 80% mylog.py
        - Core API complete but uses simplified ConsoleLogger vs Python's detailed logging config (handlers, formatters, environment-based levels)
    - batches
        - MISSING local_note_updater.py
    - configuration
        - 100% configuration_value.py
        - 100% settings.py
    - dotnet
        - EXCLUDED load_dotnet_runtime.py
    - language_services
        - 100% conjugator.py
        - 100% hiragana_chart.py
        - 100% katakana_chart.py
        - jamdict_ex
            - 80% dict_entry.py
                - FormatAnswer() is simplified - missing complex logic for transitive/intransitive/to-be verb formatting
            - 100% dict_lookup.py
            - 100% dict_lookup_result.py
            - 90% jamdict_threading_wrapper.py
                - Extra public method: Stop() not in Python
            - 100% priority_spec.py
                - Note: C# fixes bugs in Python where wrong frequency set was used for medium/low priorities
        - janome_ex
            - tokenizing
                - 100% analysis_token.py
                - 100% godan_dictionary_form_stem.py
                - 90% inflection_forms.py
                    - Extra public method: GetByName() not in Python - intentional enhancement for C# usability
                - 90% inflection_types.py
                    - Extra public method: GetByName() not in Python - intentional enhancement for C# usability
                - 100% jn_parts_of_speech.py
                - 100% jn_token.py
                - 100% jn_tokenized_text.py
                - 100% jn_tokenizer.py
                - 100% split_token.py
                - pre_processing_stage
                    - 100% dictionary_form_verb_splitter.py
                    - 100% godan_imperative_splitter.py
                    - 90% ichidan_godan_potential_or_imperative_hybrid_splitter.py
                        - Extra public methods: BaseFormHasGodanPotentialEnding(), IsIchidanHidingGodan(), TryGetGodanHiddenByIchidan() - these are private in Python
                    - 100% ichidan_imperative_splitter.py
                    - 100% pre_processing_stage.py
                    - 70% word_info.py
                        - Lookup() method has incomplete implementation - DictLookup.LookupWord() not implemented (TODO comment)
                    - 60% word_info_entry.py
                        - DictWordInfoEntry has incomplete implementation with TODO comments; uses hardcoded strings instead of POS constants; Answer property returns placeholder text
            - word_extraction
                - 100% analysis_constants.py
                - 100% candidate_word.py
                - 100% candidate_word_variant.py
                - 100% text_analysis.py
                - 100% text_location.py
                - 100% word_exclusion.py
                - matches
                    - 100% dictionary_match.py
                    - 100% match.py
                    - 100% missing_match.py
                    - 100% vocab_match.py
                    - requirements
                        - 100% custom_forbids_no_cache.py
                        - 100% match_inspector.py
                        - 100% requirement.py
                        - 100% vocab_match_inspector.py
                    - state_tests
                        - 100% another_match_owns_the_form.py
                        - 100% forbids_compositionally_transparent_compound.py
                        - 100% forbids_compounds.py
                        - 100% forbids_dictionary_form_verb_inflection.py
                        - 100% forbids_dictionary_form_verb_stem_surface_as_compound_end.py
                        - 100% forbids_yields_to_surface.py
                        - 100% is_configured_hidden.py
                        - 100% is_configured_incorrect.py
                        - 100% is_exact_match.py
                        - 100% is_godan_imperative_surface_with_base.py
                        - 100% is_godan_potential_surface_with_base.py
                        - 100% is_ichidan_imperative.py
                        - 100% is_inflected_surface_with_valid_base.py
                        - 100% is_poison_word.py
                        - 100% is_shadowed.py
                        - 100% is_single_token.py
                        - 100% starts_with_godan_imperative_stem_or_inflection.py
                        - 100% starts_with_godan_potential_stem_or_inflection.py
                        - 100% surface_is_in.py
                        - head
                            - 100% failed_match_requirement.py
                            - 100% generic_forbids.py
                            - 100% has_godan_imperative_prefix.py
                            - 100% has_past_tense_stem.py
                            - 100% has_te_form_stem.py
                            - 100% is_sentence_start.py
                            - 100% prefix_is_in.py
                            - 100% requires_forbids_adverb_stem.py
                            - 100% requires_forbids_masu_stem.py
                            - 100% requires_or_forbids_dictionary_form_prefix.py
                            - 100% requires_or_forbids_dictionary_form_stem.py
                            - 100% requires_or_forbids_generic.py
                        - tail
                            - 100% forbids_has_displayed_overlapping_following_compound.py
                            - 100% is_sentence_end.py
                            - 100% suffix_is_in.py
    - note
        - 100% backend_note_creator.py
        - 40% difficulty_calculator.py
            - AllowedSeconds() has incomplete implementation with TODO comments; character counting not implemented (all counts hardcoded to 0); IsOtherCharacter() has placeholder logic
        - 100% jpnote.py
        - 100% jpnote_data.py
        - 90% kanjinote.py
            - Missing public method: tag_vocab_readings()
        - 20% kanjinote_mnemonic_maker.py
            - CreateDefaultMnemonic() is a stub implementation; missing entire complex algorithm with readings mappings, fragmentary matching, dead-end path removal, shortest path finding
        - 80% note_constants.py
            - Core constants present but C# has reorganized structure with additional fields; missing Mine class
        - 100% note_flush_guard.py
        - 100% note_tags.py
        - 100% tag.py
        - 100% tags.py
        - collection
            - 100% card_studying_status.py
            - 100% jp_collection.py
            - 100% kanji_collection.py
            - 90% note_cache.py
                - Complete except TaskRunner integration in InitFromList has TODO comment
            - 50% sentence_collection.py
                - Missing public methods: with_vocab_owned_form(), with_vocab_marked_invalid(), with_highlighted_vocab(); SentenceSnapshot has TODO - all properties return empty arrays; PotentiallyMatchingVocab() has TODO - returns empty list
            - 100% vocab_collection.py
        - notefields
            - 100% audio_field.py
            - 70% caching_mutable_string_field.py
                - LazyReader implementation was broken (empty callback instead of calling lazy.Reset); needs fix now that LazyCE.Reset exists
            - 40% comma_separated_strings_list_field.py
                - Uses MutableStringField instead of CachingMutableStringField; no caching (re-parses on every Get() call); missing LazyReader method
            - 100% comma_separated_strings_list_field_de_duplicated.py
            - 100% fallback_string_field.py
            - 100% integer_field.py
            - 100% json_object_field.py
            - 100% mutable_string_field.py
            - 100% require_forbid_flag_field.py
            - 100% sentence_question_field.py
            - 100% strip_html_on_read_fallback_string_field.py
            - 100% tag_flag_field.py
            - auto_save_wrappers
                - 100% field_wrapper.py
                - 100% set_wrapper.py
                - 100% value_wrapper.py
        - sentences
            - 100% caching_sentence_configuration_field.py
            - 100% parsed_match.py
            - 100% parsing_result.py
            - 60% sentence_configuration.py
                - Missing factory methods: FromIncorrectMatches(), FromHiddenMatches(), FromValues()
            - 100% sentencenote.py
            - 100% user_fields.py
            - 40% word_exclusion_set.py
                - File contains 3 classes (WordExclusion, JsonReader, WordExclusionSet) instead of just WordExclusionSet; extra public methods: Empty(), Empty(Action), IsEmpty()
            - serialization
                - 70% parsed_word_serializer.py
                    - ToRow() and FromRow() are instance methods instead of static methods
                - 100% parsing_result_serializer.py
                - 50% sentence_configuration_serializer.py
                    - Extra public member: Instance property (singleton pattern not in Python); contains extra JsonHelper class; JsonHelper has incomplete TODO implementations
        - vocabulary
            - 100% pos.py
            - 100% pos_set_interner.py
            - 100% vocabnote.py
            - 20% vocabnote_audio.py
                - All audio fields commented out with TODO; GetPrimaryAudioPath() and GetPrimaryAudio() return empty strings; ToString() returns empty string
            - MISSING vocabnote_cloner.py
            - 100% vocabnote_conjugator.py
            - 80% vocabnote_factory.py
                - CreateWithDictionary() has incomplete implementation with TODO comments for dictionary lookup (falls back to creating empty note)
            - 40% vocabnote_forms.py
                - Wrong field type (MutableCommaSeparatedStringsListField instead of DeDuplicated); no lazy caching; missing methods: all_list_notes_by_sentence_count(), not_owned_by_other_vocab(), without_noise_characters(); extra public method: OwnedForms()
            - 50% vocabnote_generated_data.py
                - Large section of UpdateGeneratedData() commented out with TODO for dictionary lookup and form generation; PushAnswerToOtherSynonyms() has TODO
            - 100% vocabnote_kanji.py
            - 80% vocabnote_matching_rules.py
                - VocabNoteMatchingRulesSerializer has stub implementations - Deserialize() returns empty data; Serialize() has incomplete TODO implementation
            - MISSING vocabnote_matching_rules_is_inflecting_word.py
            - MISSING vocabnote_matching_rules_yield_last_token_to_next_compound.py
            - MISSING vocabnote_meta_tag.py
            - 70% vocabnote_metadata.py
                - MetaTagsHtml() has TODO - returns empty string instead of generating meta tags
            - 60% vocabnote_parts_of_speech.py
                - Multiple methods with TODO - IsUk() returns false; SetAutomaticallyFromDictionary() stubbed out; IsPassiveVerbCompound() returns false; IsCausativeVerbCompound() returns false; IsCompleteNaAdjective() simplified; POSSetManager not implemented
            - 100% vocabnote_question.py
            - 100% vocabnote_register.py
            - 100% vocabnote_sentences.py
            - 100% vocabnote_sorting.py
            - 60% vocabnote_usercompoundparts.py
                - AutoGenerate() not implemented (just TODO comment); missing _collection property
            - 100% vocabnote_userfields.py
            - related_vocab
                - 100% Antonyms.py
                - 100% ergative_twin.py
                - 100% perfect_synonyms.py
                - 100% related_vocab.py
                - 100% related_vocab_data.py
                - 100% related_vocab_data_serializer.py
                - 100% SeeAlso.py
                - 100% Synonyms.py
            - serialization
                - MISSING matching_rules_serializer.py
    - task_runners
        - 90% i_task_progress_runner.py
            - C# file also contains InvisibleTaskRunner class which should be in separate file
        - MISSING invisible_task_progress_runner.py
        - 100% task_progress_runner.py
    - testutils
        - MISSING ex_pytest.py
    - ui
        - web
            - sentence
                - MISSING candidate_word_variant_viewmodel.py
                - MISSING compound_part_viewmodel.py
                - MISSING match_viewmodel.py
                - MISSING sentence_viewmodel.py
                - MISSING text_analysis_viewmodel.py
            - vocab
                - MISSING vocab_sentences_vocab_sentence_view_model.py
    - viewmodels
        - kanji_list
            - MISSING kanji_list_viewmodel.py
            - MISSING sentence_kanji_list_viewmodel.py
            - MISSING sentence_kanji_viewmodel.py

---

## Summary Statistics
- **CREATED WIP**: 30 files
- **MISSING**: 124 files
- **COMPLETE**: 11 files
- **Total Python files**: 165 files
- **Completion**: ~25%

