# JAStudio Python to C# Porting Status

## Porting Rules

**Stay faithful to the Python - refactoring comes later.** We want almost completely equivalent code, only in C#.

### Why Stay So Close?

Staying this close to the Python is what makes the porting workable at all. If we start changing things while porting, it's like letting go with both hands while climbing - we have nothing to rely on, nothing keeping us from falling. **Mirroring the Python is our handgrip.** Until we have all the tests ported and working, NO significant redesigns or "fixes" will be done, even if we spot inconsistencies or improvements.

### Rules

- **File structure:** Classes should be in the equivalent file in C# as in Python. Do not put them in other files willy-nilly.
- **Naming - files:** Python filename `my_class_name.py` becomes `MyClassName.cs`. Underscores convert to PascalCase, but don't rename the file to something completely different.
- **Naming - classes/members:** Use .NET naming standards (PascalCase for public members, etc.) but keep the same names. `my_function_name` becomes `MyFunctionName`, not something completely different.
- **Public API must match:** New public methods, properties, or fields on a class count as NOT matching unless there is a documented good reason. If Python has methods A, B, C then C# should have methods A, B, C - not A, B, C, D. Extra public members mean other code has changed, breaking the faithful port.
- **Mirror inconsistencies:** Even if the Python has inconsistencies (class names not matching file names, weird organization, etc.), mirror them in C#. Do NOT "fix" inconsistencies as part of porting.
- **WeakRef:** Replace with standard references in .NET (C# has better garbage collection).
- **Class organization:** If a class is in a separate file in Python, it should be in the equivalent .cs file. If classes are together in the same file in Python, same for C#.
- **Missing dependencies:** When ported code doesn't compile due to missing classes, create them. If too complex to implement immediately, create members throwing `NotImplementedException`.
- **Implementation completeness:** Either fully implement a member or throw `NotImplementedException`. Do NOT return nonsense values.
- **Constants/literals:** Do NOT create new constants or magic literals duplicating existing ones. Access constants from the .NET equivalent of the classes they're in in Python.
- **No code duplication:** If the Python file uses constants and/or methods defined in another class/module, the C# should too unless there is a really good reason. Don't duplicate - reference the original.
- **String interning:** Python-specific optimization for memory management. Not needed in C# - skip it.
- **Different implementation vs different functionality:**
  - **Different implementation = OK** (e.g., List vs QSet, WeakRef vs direct reference, different but equivalent algorithms)
  - **Different functionality = BROKEN** If the code doesn't behave the same way, it's incomplete/buggy and must be marked with a lower percentage explaining what's broken.

## Legend
- **CREATED WIP** - C# equivalent exists but needs verification for equivalence
- **MISSING** - No C# equivalent exists yet
- **COMPLETE** - C# equivalent verified as functionally equivalent to Python
  **EXCLUDED** - Should not be ported.

---

## File Structure

- Root
    - 90% app.py
        - All core functionality present; uses List vs QSet, path computation slightly different
    - 80% mylog.py
        - Core API complete but uses simplified ConsoleLogger vs Python's detailed logging config (handlers, formatters, environment-based levels)
- batches
    - MISSING local_note_updater.py
- configuration
    - 100% configuration_value.py
    - 100% settings.py
- dotnet
    - EXCLUDE load_dotnet_runtime.py
- language_services
    - 100% conjugator.py
    - 100% hiragana_chart.py
    - 100% katakana_chart.py
    - jamdict_ex
        - MISSING dict_entry.py
        - MISSING dict_lookup.py
        - MISSING dict_lookup_result.py
        - MISSING jamdict_threading_wrapper.py
        - MISSING priority_spec.py
    - janome_ex
        - tokenizing
            - MISSING analysis_token.py
            - MISSING godan_dictionary_form_stem.py
            - MISSING inflection_forms.py
            - MISSING inflection_types.py
            - MISSING jn_parts_of_speech.py
            - MISSING jn_token.py
            - MISSING jn_tokenized_text.py
            - MISSING jn_tokenizer.py
            - MISSING split_token.py
            - pre_processing_stage
                - MISSING dictionary_form_verb_splitter.py
                - MISSING godan_imperative_splitter.py
                - MISSING ichidan_godan_potential_or_imperative_hybrid_splitter.py
                - MISSING ichidan_imperative_splitter.py
                - MISSING pre_processing_stage.py
                - MISSING word_info.py
                - MISSING word_info_entry.py
        - word_extraction
            - MISSING analysis_constants.py
            - MISSING candidate_word.py
            - MISSING candidate_word_variant.py
            - MISSING text_analysis.py
            - MISSING text_location.py
            - 30% word_exclusion.py
                - C# merged WordExclusion + WordExclusionSet into one file (should be separate); missing _match_part field, excludes_all_words_excluded_by method, equality/hash
            - matches
                - MISSING dictionary_match.py
                - 10% match.py
                    - Stub with basic properties only; missing validation system, MatchInspector, caching, requirements, abstract methods
                - MISSING missing_match.py
                - 10% vocab_match.py
                    - Stub only; VocabMatch defined in Match.cs instead of separate file
                - requirements
                    - MISSING custom_forbids_no_cache.py
                    - MISSING match_inspector.py
                    - MISSING requirement.py
                    - MISSING vocab_match_inspector.py
                - state_tests
                    - MISSING another_match_owns_the_form.py
                    - MISSING forbids_compositionally_transparent_compound.py
                    - MISSING forbids_compounds.py
                    - MISSING forbids_dictionary_form_verb_inflection.py
                    - MISSING forbids_dictionary_form_verb_stem_surface_as_compound_end.py
                    - MISSING forbids_yields_to_surface.py
                    - MISSING is_configured_hidden.py
                    - MISSING is_configured_incorrect.py
                    - MISSING is_exact_match.py
                    - MISSING is_godan_imperative_surface_with_base.py
                    - MISSING is_godan_potential_surface_with_base.py
                    - MISSING is_ichidan_imperative.py
                    - MISSING is_inflected_surface_with_valid_base.py
                    - MISSING is_poison_word.py
                    - MISSING is_shadowed.py
                    - MISSING is_single_token.py
                    - MISSING starts_with_godan_imperative_stem_or_inflection.py
                    - MISSING starts_with_godan_potential_stem_or_inflection.py
                    - MISSING surface_is_in.py
                    - head
                        - MISSING failed_match_requirement.py
                        - MISSING generic_forbids.py
                        - MISSING has_godan_imperative_prefix.py
                        - MISSING has_past_tense_stem.py
                        - MISSING has_te_form_stem.py
                        - MISSING is_sentence_start.py
                        - MISSING prefix_is_in.py
                        - MISSING requires_forbids_adverb_stem.py
                        - MISSING requires_forbids_masu_stem.py
                        - MISSING requires_or_forbids_dictionary_form_prefix.py
                        - MISSING requires_or_forbids_dictionary_form_stem.py
                        - MISSING requires_or_forbids_generic.py
                    - tail
                        - MISSING forbids_has_displayed_overlapping_following_compound.py
                        - MISSING is_sentence_end.py
                        - MISSING suffix_is_in.py
- note
    - 100% backend_note_creator.py
    - CREATED WIP difficulty_calculator.py
    - 100% jpnote.py
    - 100% jpnote_data.py
    - CREATED WIP kanjinote.py
    - CREATED WIP kanjinote_mnemonic_maker.py
    - 80% note_constants.py
        - Core constants present but C# has reorganized structure with additional fields; missing Mine class
    - CREATED WIP note_flush_guard.py
        - Wrong name: NoteRecursiveFlushGuard instead of NoteFlushGuard
    - 100% note_tags.py
    - 100% tag.py
    - 100% tags.py
    - collection
        - CREATED WIP card_studying_status.py
        - 100% jp_collection.py
        - CREATED WIP kanji_collection.py
        - 90% note_cache.py
            - Complete except TaskRunner integration in InitFromList has TODO comment
        - CREATED WIP sentence_collection.py
        - CREATED WIP vocab_collection.py
    - notefields
        - 100% audio_field.py
        - 70% caching_mutable_string_field.py
            - LazyReader implementation was broken (empty callback instead of calling lazy.Reset); needs fix now that LazyCE.Reset exists
        - 40% comma_separated_strings_list_field.py
            - Uses MutableStringField instead of CachingMutableStringField; no caching (re-parses on every Get() call); missing LazyReader method
        - 100% comma_separated_strings_list_field_de_duplicated.py
        - 100% fallback_string_field.py
        - 100% integer_field.py
        - 50% json_object_field.py
            - File renamed to SerializedObjectField.cs instead of JsonObjectField.cs; class renamed to SerializedObjectField instead of MutableSerializedObjectField
        - 100% mutable_string_field.py
        - 100% require_forbid_flag_field.py
        - 100% sentence_question_field.py
        - 100% strip_html_on_read_fallback_string_field.py
        - 100% tag_flag_field.py
        - auto_save_wrappers
            - MISSING field_wrapper.py
            - MISSING set_wrapper.py
            - MISSING value_wrapper.py
    - sentences
        - 100% caching_sentence_configuration_field.py
        - 100% parsed_match.py
        - 100% parsing_result.py
        - 60% sentence_configuration.py
            - Missing factory methods: FromIncorrectMatches(), FromHiddenMatches(), FromValues()
        - 50% sentencenote.py
            - File in wrong location (Note\SentenceNote.cs instead of Note\Sentences\SentenceNote.cs); needs comparison of public API
        - 50% user_fields.py
            - Wrong file name: SentenceUserFields.cs instead of UserFields.cs
        - 40% word_exclusion_set.py
            - File contains 3 classes (WordExclusion, JsonReader, WordExclusionSet) instead of just WordExclusionSet; extra public methods: Empty(), Empty(Action), IsEmpty()
        - serialization
            - 70% parsed_word_serializer.py
                - ToRow() and FromRow() are instance methods instead of static methods
            - 100% parsing_result_serializer.py
            - 50% sentence_configuration_serializer.py
                - Extra public member: Instance property (singleton pattern not in Python); contains extra JsonHelper class; JsonHelper has incomplete TODO implementations
    - vocabulary
        - MISSING pos.py
        - MISSING pos_set_interner.py
        - 50% vocabnote.py
            - File in wrong location (Note\VocabNote.cs instead of Note\Vocabulary\VocabNote.cs); needs comparison of public API
        - CREATED WIP vocabnote_audio.py
        - MISSING vocabnote_cloner.py
        - 100% vocabnote_conjugator.py
        - CREATED WIP vocabnote_factory.py
        - 40% vocabnote_forms.py
            - Wrong field type (MutableCommaSeparatedStringsListField instead of DeDuplicated); no lazy caching; missing methods: all_list_notes_by_sentence_count(), not_owned_by_other_vocab(), without_noise_characters(); extra public method: OwnedForms()
        - CREATED WIP vocabnote_generated_data.py
        - CREATED WIP vocabnote_kanji.py
        - CREATED WIP vocabnote_matching_rules.py
        - MISSING vocabnote_matching_rules_is_inflecting_word.py
        - MISSING vocabnote_matching_rules_yield_last_token_to_next_compound.py
        - MISSING vocabnote_meta_tag.py
        - CREATED WIP vocabnote_metadata.py
        - CREATED WIP vocabnote_parts_of_speech.py
        - CREATED WIP vocabnote_question.py
        - CREATED WIP vocabnote_register.py
        - CREATED WIP vocabnote_sentences.py
        - CREATED WIP vocabnote_sorting.py
        - 60% vocabnote_usercompoundparts.py
            - AutoGenerate() not implemented (just TODO comment); missing _collection property
        - CREATED WIP vocabnote_userfields.py
        - related_vocab
            - MISSING Antonyms.py
            - MISSING ergative_twin.py
            - MISSING perfect_synonyms.py
            - 40% related_vocab.py
                - Wrong class name (VocabRelatedNotes instead of RelatedVocab); missing all related vocab fields (ergative_twin, synonyms, perfect_synonyms, antonyms, see_also, derived_from, confused_with) - just TODO comments
            - MISSING related_vocab_data.py
            - MISSING related_vocab_data_serializer.py
            - MISSING SeeAlso.py
            - MISSING Synonyms.py
        - serialization
            - MISSING matching_rules_serializer.py
- task_runners
    - CREATED WIP i_task_progress_runner.py
        - Wrong name: ITaskRunner instead of ITaskProgressRunner
    - MISSING invisible_task_progress_runner.py
    - CREATED WIP task_progress_runner.py
- testutils
    - MISSING ex_pytest.py
- ui
    - web
        - sentence
            - MISSING candidate_word_variant_viewmodel.py
            - MISSING compound_part_viewmodel.py
            - MISSING match_viewmodel.py
            - MISSING sentence_viewmodel.py
            - MISSING text_analysis_viewmodel.py
        - vocab
            - MISSING vocab_sentences_vocab_sentence_view_model.py
- viewmodels
    - kanji_list
        - MISSING kanji_list_viewmodel.py
        - MISSING sentence_kanji_list_viewmodel.py
        - MISSING sentence_kanji_viewmodel.py

---

## Summary Statistics
- **CREATED WIP**: 30 files
- **MISSING**: 135 files
- **COMPLETE**: 0 files
- **Total Python files**: 165 files
- **Completion**: ~18%

